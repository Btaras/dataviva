<!-- extend admin_template -->
{% extends "templates/account.html" %}

{% block admin_content %}

<h5>Starred <i class=" icon-star-empty"></i></h5>
<hr class="bold"/>

<div class="feed"></div>

<script src="/static/js/utils/utils.infinite_scroll.js"></script>
<script>


function item_formatter(container_el, activities){
  
  var formatDate = d3.time.format("%B %-d, %Y"),
      parseDate = d3.time.format.iso.parse;
  
  var activities_enter = d3.select(container_el).selectAll(".activity")
    .data(activities, function(d){ return d.app_id; })
    .enter().insert("a", "div.loading")
      .attr("class", "activity")
      .attr("href", function(d){
        return "/embed/" + d.app_id;
      })
      .append("div")
      .attr("class", "feed-item")
  
  // the title div housing the icon and title
  var title_div = activities_enter.append("div")
      .attr("class", "feed_title")
  
  // add icon
  title_div.append("img")
    .attr("src", function(d){
      var app_type = d.app_id.split("/")[0]
      return "/static/img/icons/tiles/"+app_type+"_tile.png";
    })
    .attr("width", "23px")
    .attr("padding-bottom", "23px")

    // the title (strip out HTML!)
    title_div.append("p")
      .html(function(d){
        return d.app_name;
      })
      
    // lastly, the div that holds the data
    activities_enter.append("div")
        .attr("class", "feed_date")
        .text(function(d) { 
          return formatDate(parseDate(d.timestamp)); 
        });

}

var is = infinite_scroll()
          .format_items(item_formatter);

d3.select(".feed")
  .call(is)

</script>

{% endblock %}