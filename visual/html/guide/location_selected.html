<div id="sabrina_location_select" class="grid5col1 grid5offset1"></div>
<div id="location_options" class="grid5col2">
  
  <div class="title">
    <div class="arrow"></div>
    <div class="text">
      What would you like to know about my location?
    </div>
  </div>

  <div class="decision" name="opportunity">
    <div class="text">
      What are the <b>industrial opportunities</b>?
    </div>
    <div class="arrow"></div>
  </div>
  
  <div class="decision" name="attract">
    <div class="text">
      How can I <b>attract an industry</b>?
    </div>
    <div class="arrow"></div>
  </div>

  <div class="decision" name="growth">
    <div class="text">
      Which industries are <b>growing</b>?
    </div>
    <div class="arrow"></div>
  </div>

  <div class="decision" name="shrink">
    <div class="text">
      Which industries are <b>shrinking</b>?
    </div>
    <div class="arrow"></div>
  </div>

  <div class="decision" name="workforce">
    <div class="text">
      What is the available <b>workforce</b>?
    </div>
    <div class="arrow"></div>
  </div>

  <div class="decision" name="industry">
    <div class="text">
      What are the present <b>industries</b>?
    </div>
    <div class="arrow"></div>
  </div>

  <!-- <div class="decision" name="career">
    <div class="text">
      Information about a <b>specific occupation</b>?
    </div>
    <div class="arrow"></div>
  </div> -->
  
</div>

<script>

  visual.sabrina({
    "div": d3.select("#sabrina_location_select"),
    "outfit": "travel",
    "emotion": "smirk"
  })
  
  d3.selectAll("div.decision")
    .on(vizwhiz.evt.click,function(){
      var name = d3.select(this).attr("name")
      update_path(name);
    })
    
  if (current_path[1] == "all") {
    d3.json("/attrs/wld/sabra/", function(data){
      replace_name(data.data[0].name);
    })
  } else {
    if (current_path[1].indexOf(".") >= 0) {
      var split = current_path[1].split("."),
          id = split[0],
          distance = split[1]
    }
    else {
      var id = current_path[1],
          distance = 0
    }
    d3.json("/attrs/bra/"+id, function(data){
      if (distance == 0) {
        var name = data.data[0].name
      }
      else {
        var name = data.data[0].name + " (within "+distance+"km)";
      }
      replace_name(name);
    })
  }
  
  function replace_name(geo_name) {
    d3.selectAll("div.question")
      .each(function(){
        var text = d3.select(this).html();
        text = text.replace("my location",geo_name)
        d3.select(this).html(text)
      })
  }

</script>