<!-- extend from base layout -->
{% extends "templates/site.html" %}

{% block title %}: App Builder{% endblock %}

{% block body %}

  </div>
  <div id="app_buffer">
  <iframe class="app_builder"></iframe>

{% endblock %}

{% block js %}

  <script>
  
    var w = window.innerWidth-20,
        h = window.innerHeight-100,
        aspect = w/h
        
    if (aspect >= 6/4) {
      var height = h, width = h*(6/4)
    }
    else {
      var height = w/(6/4), width = w
    }
    console.log(window.location.pathname.replace("builder","embed"))
    d3.select("iframe.app_builder")
      .style("height",height+"px")
      .style("width",width+"px")
      .style("margin-left",-(width/2)+"px")
      .attr("src",window.location.pathname.replace("builder","embed"))
      
    d3.select("div#app_buffer")
      .style("height",height+"px")
      
    update_url = function(url) {
      console.log(url)
    }

  </script>

{% endblock %}